<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OTP Panel</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { background:#121212; color:#fff; padding:30px; font-family: 'Segoe UI', sans-serif; }
.container { max-width: 700px; margin:auto; }
.card { background:#1f1f1f; margin-bottom:20px; border-radius:10px; }
.card h3 { margin-bottom:15px; }
input, button { border-radius:6px; }
button { background:#28a745; color:white; border:none; padding:10px; width:100%; }
input { padding:10px; margin-bottom:10px; width:100%; border:none; }
table { width:100%; margin-top:15px; }
th, td { padding:8px; text-align:center; }
th { background:#333; }
td { background:#222; }
</style>
</head>
<body>
<div class="container">
<h2 class="mb-4">Manage OTP Bot Groups</h2>

<div class="card p-3">
<h3>Tambah Source (Grup Sumber)</h3>
<input id="source_id" type="number" placeholder="Masukkan Chat ID">
<button onclick="addSource()">Tambah Source</button>
<div id="source_list"></div>
</div>

<div class="card p-3">
<h3>Tambah Target (Grup Tujuan)</h3>
<input id="target_id" type="number" placeholder="Masukkan Chat ID">
<button onclick="addTarget()">Tambah Target</button>
<div id="target_list"></div>
</div>
</div>

<script>
async function fetchSources() {
    let res = await fetch("/api/get_sources");
    let data = await res.json();
    let html = "<table><tr><th>Chat ID</th><th>Aksi</th></tr>";
    data.forEach(id=>{ html += `<tr><td>${id}</td><td><button onclick="deleteSource(${id})">Hapus</button></td></tr>`; });
    html += "</table>";
    document.getElementById("source_list").innerHTML = html;
}

async function fetchTargets() {
    let res = await fetch("/api/get_targets");
    let data = await res.json();
    let html = "<table><tr><th>Chat ID</th><th>Aksi</th></tr>";
    data.forEach(id=>{ html += `<tr><td>${id}</td><td><button onclick="deleteTarget(${id})">Hapus</button></td></tr>`; });
    html += "</table>";
    document.getElementById("target_list").innerHTML = html;
}

async function addSource() {
    let id = document.getElementById("source_id").value;
    await fetch("/api/add_source", { method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify({chat_id:Number(id)}) });
    fetchSources();
}

async function addTarget() {
    let id = document.getElementById("target_id").value;
    await fetch("/api/add_target", { method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify({chat_id:Number(id)}) });
    fetchTargets();
}

async function deleteSource(id){
    await fetch("/api/delete_source", { method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify({chat_id:id}) });
    fetchSources();
}

async function deleteTarget(id){
    await fetch("/api/delete_target", { method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify({chat_id:id}) });
    fetchTargets();
}

fetchSources();
fetchTargets();
</script>
</body>
</html>